<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>GRMF Cast Player</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.8/dist/hls.min.js"></script>

<style>
html,body{
  margin:0;width:100%;height:100%;
  background:#020817;
  font-family:system-ui,Arial,sans-serif;
  overflow:hidden;
}
video{
  width:100%;height:100%;object-fit:contain;
  background:radial-gradient(circle,#0b1430,#020817 60%,#000);
}

/* Overlay */
.overlay{
  position:absolute;inset:0;
  background:linear-gradient(to top,rgba(2,8,23,.98),transparent);
  display:flex;flex-direction:column;justify-content:flex-end;
  padding:24px;
  opacity:0;pointer-events:none;
  transition:.25s ease;
}
.overlay.show{opacity:1;pointer-events:auto}

/* Seek UI */
.seek-row{display:flex;align-items:center;gap:12px;margin-bottom:14px}
.time{color:#fff;font-size:12px;min-width:60px;text-align:center}
.bar{
  flex:1;height:6px;border-radius:999px;
  background:#334155;position:relative;overflow:hidden
}
.fill{
  height:100%;width:0%;
  background:linear-gradient(90deg,#facc15,#f59e0b);
  box-shadow:0 0 14px rgba(250,204,21,.7)
}

/* Thumbnail preview */
.thumb-preview{
  position:absolute;
  bottom:42px;
  transform:translateX(-50%);
  background:#000;
  border-radius:8px;
  overflow:hidden;
  display:none;
  border:2px solid #facc15;
}
.thumb-preview img{
  display:block;
  width:160px;height:90px;
  object-fit:cover;
}
.thumb-time{
  text-align:center;
  color:#fff;background:#000c;font-size:12px;padding:2px 4px;
}

/* Controls */
.controls{
  display:flex;justify-content:space-between;
  gap:12px;flex-wrap:wrap
}
.left,.right{display:flex;gap:10px}

/* Buttons */
.btn{
  background:radial-gradient(circle at top left,#facc15,#f59e0b,#b45309);
  color:#020617;border-radius:999px;
  border:1px solid #fde047;
  padding:10px 18px;font-size:14px;font-weight:700;
  box-shadow:0 12px 28px rgba(0,0,0,.85),0 0 14px rgba(250,204,21,.45);
  transition:transform .15s, box-shadow .2s;
}
.right .btn{
  background:radial-gradient(circle at top,#1d4ed8,#020617);
  color:#e5e7eb;border-color:rgba(191,219,254,.5)
}

/* Focus */
.focus{
  transform:scale(1.12);
  box-shadow:
    0 0 0 3px #facc15,
    0 0 0 6px rgba(30,64,175,.85),
    0 16px 40px rgba(0,0,0,.95);
}

/* Quality menu */
.menu{
  position:absolute;right:24px;bottom:170px;
  background:#020617f0;border-radius:14px;
  padding:10px;display:none;flex-direction:column;gap:6px;
  border:1px solid #334155;
}
.menu-item{
  padding:6px 12px;border-radius:8px;
  font-size:13px;color:#e5e7eb
}
.menu-item.active{
  background:linear-gradient(90deg,#facc15,#f59e0b);
  color:#020617;font-weight:700
}
.menu-item.selected{
  outline:2px solid #60a5fa;
}
</style>
</head>
<body>

<video id="video" crossorigin="anonymous"></video>

<div id="overlay" class="overlay">
  <div class="seek-row" id="seekRow">
    <div id="cur" class="time">0:00</div>
    <div id="bar" class="bar">
      <div id="fill" class="fill"></div>

      <div id="thumb" class="thumb-preview">
        <img id="thumbImg" src="" />
        <div id="thumbTime" class="thumb-time">0:00</div>
      </div>
    </div>
    <div id="dur" class="time">0:00</div>
  </div>

  <div class="controls">
    <div class="left">
      <button id="bBack" class="btn">‚è™ 10s</button>
      <button id="bPlay" class="btn">‚è∏</button>
      <button id="bFwd" class="btn">10s ‚è©</button>
      <button id="bRestart" class="btn">‚ü≤</button>
    </div>
    <div class="right">
      <button id="bSubs" class="btn">Subs: On</button>
      <button id="bQuality" class="btn">Quality</button>
      <button id="bMute" class="btn">üîä</button>
    </div>
  </div>
</div>

<div id="qMenu" class="menu"></div>

<script>
const video = document.getElementById('video');
const overlay = document.getElementById('overlay');
const curEl = document.getElementById('cur');
const durEl = document.getElementById('dur');
const fill = document.getElementById('fill');
const bar = document.getElementById('bar');

const thumb = document.getElementById('thumb');
const thumbImg = document.getElementById('thumbImg');
const thumbTime = document.getElementById('thumbTime');

const bBack = document.getElementById('bBack');
const bPlay = document.getElementById('bPlay');
const bFwd = document.getElementById('bFwd');
const bRestart = document.getElementById('bRestart');
const bSubs = document.getElementById('bSubs');
const bQuality = document.getElementById('bQuality');
const bMute = document.getElementById('bMute');

const qMenu = document.getElementById('qMenu');

let hls=null,hideT;
let qItems=[],qIndex=0,qOpen=false;
let focusables=[bBack,bPlay,bFwd,bRestart,bSubs,bQuality,bMute];
let fIndex=-1;

let seekMode=false;
let virtualSeek=0;

/* helpers */
const fmt=t=>{
  if(!t||isNaN(t))return"0:00";
  const m=Math.floor(t/60);
  const s=Math.floor(t%60).toString().padStart(2,"0");
  return `${m}:${s}`;
};

function showUI(){
  overlay.classList.add("show");
  clearTimeout(hideT);
  hideT=setTimeout(()=>{overlay.classList.remove("show");clearFocus();seekMode=false;thumb.style.display="none"},5000);
}

function clearFocus(){
  focusables.forEach(b=>b.classList.remove("focus"));fIndex=-1;
}
function moveFocus(d){
  if(fIndex==-1)fIndex=0;
  else fIndex=(fIndex+d+focusables.length)%focusables.length;
  focusables.forEach(b=>b.classList.remove("focus"));
  focusables[fIndex].classList.add("focus");
}

/* Quality highlight */
function highlightQ(){
  [...qMenu.children].forEach((el,i)=>{
    el.classList.toggle("active",i===qIndex);
  });
}

/* Fake thumbnails (placeholder) */
function updateThumb(pos){
  const rect=bar.getBoundingClientRect();
  const pct=pos/video.duration;
  const x=pct*rect.width;
  thumb.style.left=x+"px";
  thumb.style.display="block";
  thumbTime.textContent=fmt(pos);

  // placeholder thumb
  thumbImg.src="https://dummyimage.com/320x180/000/fff&text="+fmt(pos);
}

/* Stream load */
window.addEventListener("message",e=>{
  const d=e.data||{};
  if(d.type==="LOAD_STREAM"){
    video.src=d.url;
    video.play();
    showUI();
  }

  if(d.type==="REMOTE_KEY"){
    showUI();

    switch(d.key){

      /* navigation */
      case "ArrowLeft":
        if(seekMode){
          virtualSeek=Math.max(0,virtualSeek-10);
          updateThumb(virtualSeek);
        }else moveFocus(-1);
      break;

      case "ArrowRight":
        if(seekMode){
          virtualSeek=Math.min(video.duration,virtualSeek+10);
          updateThumb(virtualSeek);
        }else moveFocus(1);
      break;

      case "ArrowUp":
        seekMode=true;
        virtualSeek=video.currentTime;
        updateThumb(virtualSeek);
      break;

      case "ArrowDown":
        seekMode=false;
        thumb.style.display="none";
      break;

      /* R1 / L1 skip */
      case "MediaNextTrack":
      case "ChannelUp":
        video.currentTime+=10;
      break;

      case "MediaPreviousTrack":
      case "ChannelDown":
        video.currentTime=Math.max(0,video.currentTime-10);
      break;

      case "Enter":
        if(seekMode){
          video.currentTime=virtualSeek;
          seekMode=false;
          thumb.style.display="none";
        }else if(fIndex>=0){
          focusables[fIndex].click();
        }else{
          video.paused?video.play():video.pause();
        }
      break;
    }
  }
});

/* Time updates */
video.addEventListener("timeupdate",()=>{
  if(!video.duration) return;
  curEl.textContent=fmt(video.currentTime);
  durEl.textContent=fmt(video.duration);
  fill.style.width=(video.currentTime/video.duration*100)+"%";
});

/* UI buttons */
bPlay.onclick=()=>video.paused?video.play():video.pause();
bBack.onclick=()=>video.currentTime=Math.max(0,video.currentTime-10);
bFwd.onclick=()=>video.currentTime+=10;
bRestart.onclick=()=>{video.currentTime=0;video.play()};
bMute.onclick=()=>{video.muted=!video.muted;bMute.textContent=video.muted?"üîá":"üîä"};
</script>
</body>
</html>
