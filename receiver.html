<!DOCTYPE html>
<html>
<head>
  <script src="https://www.gstatic.com/cast/sdk/libs/caf_receiver/v3/cast_receiver_framework.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      background: black;
      overflow: hidden;
    }
    iframe {
      border: 0;
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>

<iframe id="playerFrame" src="player.html"></iframe>

<script>
  const NAMESPACE = 'urn:x-cast:com.med1anetwork.grmf.testchannel';
  const frame = document.getElementById('playerFrame');

  const context = cast.framework.CastReceiverContext.getInstance();

  context.addCustomMessageListener(NAMESPACE, (event) => {
    try {
      const data = typeof event.data === 'string'
        ? JSON.parse(event.data)
        : event.data;

      // Στείλ'τα στο player
      frame.contentWindow.postMessage({
        type: 'LOAD_STREAM',
        url: data.url,
        subUrl: data.subUrl
      }, '*');

    } catch (e) {}
  });

  context.start();
</script>

</body>
</html>
