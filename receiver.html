<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8">
  <title>Fullscreen HLS Player</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.8/dist/hls.min.js"></script>

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body {
      width: 100%;
      height: 100%;
      background: black;
      overflow: hidden;
      font-family: sans-serif;
    }

    .player {
      position: fixed;
      inset: 0;
      background: black;
    }

    video {
      width: 100%;
      height: 100%;
      background: black;
      object-fit: contain;
    }

    video::-webkit-media-controls {
      display: none !important;
    }

    .controls {
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: 20px;
      background: linear-gradient(to top, rgba(0,0,0,.7), transparent 50%);
      opacity: 0;
      transition: .2s ease;
      pointer-events: none;
    }

    .player:hover .controls,
    body.show-controls .controls {
      opacity: 1;
      pointer-events: auto;
    }

    .bar {
      height: 6px;
      background: rgba(255,255,255,.25);
      border-radius: 10px;
      overflow: hidden;
      cursor: pointer;
      margin-bottom: 15px;
      position: relative;
    }

    .fill {
      height: 100%;
      background: #1e90ff;
      width: 0%;
    }

    .buttons {
      display: flex;
      justify-content: center;
      gap: 15px;
    }

    button, select {
      background: rgba(0,0,0,.7);
      border: 1px solid rgba(255,255,255,.2);
      color: white;
      padding: 12px 16px;
      border-radius: 50px;
      font-size: 14px;
      cursor: pointer;
    }

    .right-controls {
      margin-top: 12px;
      display: flex;
      gap: 10px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .info {
      position: absolute;
      right: 15px;
      bottom: 15px;
      padding: 6px 10px;
      background: rgba(0,0,0,.6);
      color: #aaa;
      font-size: 11px;
      border-radius: 10px;
      display: flex;
      gap: 10px;
    }
  </style>
</head>
<body>

<div class="player">
  <video id="video" crossorigin="anonymous"></video>

  <div class="controls">
    <div class="bar" id="bar">
      <div class="fill" id="fill"></div>
    </div>

    <div class="buttons">
      <button id="play">â–¶</button>
      <button id="rewind">Â«10</button>
      <button id="forward">10Â»</button>
      <button id="subs" disabled>Subs</button>
    </div>

    <div class="right-controls">
      <select id="quality" disabled>
        <option value="-1">Auto</option>
      </select>
      <button id="mute">ðŸ”Š</button>
    </div>
  </div>

  <div class="info">
    <span id="res">Resolution: auto</span>
    <span id="tech">HTML5</span>
  </div>
</div>

<script>
/* ===============================
   Î’Î‘Î›Î• Î¤Î‘ LINKS Î£ÎŸÎ¥ Î•Î”Î©
================================== */
const VIDEO_URL = "https://icy-boat-356c.10011-8fd.workers.dev/hailmist36.pro/file2/OPPyPnl4Slab+HjmeyZo4u1zAX2Dhzg8B18K1n7MUr3jnSWsiGlLFwO8GMyo0ADgxnWyd99p28pERmEvHnueH0Kr3Vi5cB+YopkKZer3DljXgq1JhdJRfAlnzgwDzgT+V5Va5HhoK~FUPR6WLXxrejqDHDxAymrefPTv1Yla4Ac=/cGxheWxpc3QubTN1OA==.m3u8";
const SUB_URL   = "https://gist.githubusercontent.com/movieflixgr/478cc773cae72d60f3e9edd5da3442b1/raw/f10c660b985e28a077f53a5cfed609e1f186149a/%5B_Thanksgiving%202023%201080p%20WEBRip%201400MB%20DD5%201%20x264-GalaxyRG_%5D.vtt/download?filename=subs.vtt";
const SUB_LANG  = "Greek";

/* =============================== */

const video = document.getElementById("video");
const playBtn = document.getElementById("play");
const rwBtn = document.getElementById("rewind");
const fwBtn = document.getElementById("forward");
const muteBtn = document.getElementById("mute");
const subsBtn = document.getElementById("subs");

const bar = document.getElementById("bar");
const fill = document.getElementById("fill");
const quality = document.getElementById("quality");

const res = document.getElementById("res");
const tech = document.getElementById("tech");

let hls = null;

function enterFullscreen() {
  document.documentElement.requestFullscreen?.();
}

function loadPlayer() {
  if (VIDEO_URL.includes(".m3u8") && Hls.isSupported()) {
    tech.textContent = "hls.js";
    hls = new Hls();
    hls.loadSource(VIDEO_URL);
    hls.attachMedia(video);

    hls.on(Hls.Events.MANIFEST_PARSED, () => {
      video.play();
      enterFullscreen();
    });

    hls.on(Hls.Events.MANIFEST_LOADED, (_, d) => {
  quality.innerHTML = '<option value="-1">Auto</option>';

  // Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± reversed mapping
  const reversed = d.levels
    .map((lvl, i) => ({ lvl, i }))
    .reverse();

  reversed.forEach(item => {
    const opt = document.createElement("option");
    opt.value = item.i; // Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒ index
    opt.textContent = item.lvl.height
      ? item.lvl.height + "p"
      : "Level";
    quality.appendChild(opt);
  });

  quality.disabled = false;
});

    hls.on(Hls.Events.LEVEL_SWITCHED, (_, d) => {
      const level = hls.levels[d.level];
      res.textContent = level?.height
        ? "Resolution: " + level.height + "p"
        : "Resolution: auto";
    });
  } else {
    video.src = VIDEO_URL;
    video.play();
  }

  if (SUB_URL) {
    const track = document.createElement("track");
    track.kind = "subtitles";
    track.label = SUB_LANG;
    track.src = SUB_URL;
    track.srclang = "el";
    track.default = true;
    video.appendChild(track);
    video.textTracks[0].mode = "showing";
    subsBtn.disabled = false;
  }
}

/* ------- Controls ------- */

playBtn.onclick = () => video.paused ? video.play() : video.pause();
rwBtn.onclick = () => video.currentTime -= 10;
fwBtn.onclick = () => video.currentTime += 10;

muteBtn.onclick = () => {
  video.muted = !video.muted;
  muteBtn.textContent = video.muted ? "ðŸ”‡" : "ðŸ”Š";
};

subsBtn.onclick = () => {
  const t = video.textTracks[0];
  t.mode = t.mode === "showing" ? "disabled" : "showing";
};

quality.onchange = () => {
  if (!hls) return;
  const v = quality.value;
  hls.currentLevel = v === "-1" ? -1 : parseInt(v);
};

video.addEventListener("timeupdate", () => {
  if (!video.duration) return;
  fill.style.width = (video.currentTime / video.duration) * 100 + "%";
});

bar.onclick = (e) => {
  const r = bar.getBoundingClientRect();
  const p = (e.clientX - r.left) / r.width;
  video.currentTime = p * video.duration;
};

window.addEventListener("load", loadPlayer);

quality.setAttribute("tabindex", "0");

quality.addEventListener("focus", () => {
  document.body.classList.add("show-controls");
});

window.addEventListener("keydown", (e) => {
  const isTV = /TV|BRAVIA|AFT|Android TV/i.test(navigator.userAgent);

  if (!isTV) return;

  // ÎŒÏ„Î±Î½ Ï€Î±Ï„Î¬Ï‚ OK Ï€Î¬Î½Ï‰ ÏƒÏ„Î¿ quality menu
  if (
    (e.key === "Enter" || e.key === "OK") &&
    document.activeElement === quality
  ) {
    e.preventDefault();
    quality.click();     // Trick Î³Î¹Î± Android TV
    quality.size = quality.options.length; // Î±Î½Î¿Î¯Î³ÎµÎ¹ ÏƒÎ±Î½ Î»Î¯ÏƒÏ„Î±
  }

  // ÎŒÏ„Î±Î½ ÎµÏ€Î¹Î»Î­Î³ÎµÎ¹Ï‚ Ï„Î¹Î¼Î®
  if (e.key === "Escape" || e.key === "Backspace") {
    quality.size = 0;
  }
});
  
</script>

</body>
</html>
